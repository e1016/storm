!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o=e();for(var r in o)("object"==typeof exports?exports:t)[r]=o[r]}}(window,function(){return function(t){var e={};function o(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){!function(e){void 0!==t&&t.exports?t.exports.Collection=e():window.Collection=e()}(function(){var t=function(t){return JSON.parse(t)},e=function(t){return JSON.stringify(t)};if(!function(){return void 0!==localStorage&&null!==localStorage})throw"[Store Error]: local and session storage is not supported!";var o=function(t,e){if(this.storageType=e&&e.storeOnSession?"sessionStorage":"localStorage",this.callbackStack={save:[],find:[],erase:[],update:[]},!t&&"string"!=typeof t)throw new Error("session");this.collection=t};o.prototype.save=function(o){var r;if(this.callbackStack.save.forEach(function(t){t(o)}),"object"!=typeof o)throw'[Store Error]: "save" method expect a JSON';(r=t(window[this.storageType].getItem(this.collection)))?(r.push(o),window[this.storageType].setItem(this.collection,e(r))):((r=[]).push(o),window[this.storageType].setItem(this.collection,e(r)))},o.prototype.erase=function(){this.callbackStack.erase.forEach(function(t){t()}),window[this.storageType].removeItem(this.collection)};var r=function(t){t.__proto__.last=function(){return this[t.length-1]},t.__proto__.first=function(){return this[0]}},n=function(e,o,n,i){var c,s=[],f={};if(e){if("object"!=typeof e)throw'[Store Error]: "find" method expect a JSON';if(c=t(window[i].getItem(n)),o&&"string"==typeof o)for(var a in e)c.forEach(function(t){t[a]==e[a]&&(o.split(/ +/g).forEach(function(e){f[e]=t[e]}),s.push(f),f={})});else for(var a in e)c.forEach(function(t){t[a]==e[a]&&s.indexOf(t)<0&&s.push(t)});return s.length&&r(s),s}return(s=t(window[i].getItem(n)))&&r(s),s};return o.prototype.find=function(t,e){var o=n(t,e,this.collection,this.storageType);return this.callbackStack.find.forEach(function(t){t(o)}),o},o.prototype.findOne=function(t,e){var o=n(t,e,this.collection,this.storageType)[0];return this.callbackStack.find.forEach(function(t){t(o)}),o},o.prototype.update=function(o){if(!o.set||!o.where)throw'[Store Error]: "set" or "where" node missing';if("object"!=typeof o.where||"object"!=typeof o.set)throw'[Store Error]: "where" or "set" node expects objects';var r;this.callbackStack.update.forEach(function(t){t(o)});var n,i=0;for(s in o.set)0;for(w in o.where)i++;if(!(r=t(window[this.storageType].getItem(this.collection))))throw new Error("[Store Error]: has been ocurred an error trying to get data from "+this.collection);r.forEach(function(t,e){for(w in n=0,o.where)n+=o.where[w]===t[w]?1:0;if(n===i)for(s in o.set)r[e][s]=o.set[s]}),window[this.storageType].setItem(this.collection,e(r))},o.prototype.findSorted=function(t){var e,o;if("string"!=typeof t)throw"[Store Error]: Sort parameter should be String type";if(!(e=t.match(/[<|>]/)[0]))throw"[Store Error]: Error processing";o=t.replace(/[<|>]/,"").trim();var r=n(void 0,void 0,this.collection,this.storageType).sort(function(t,r){return"<"===e?t[o]<r[o]:t[o]>r[o]});return this.callbackStack.find.forEach(function(t){t(r)}),r},o.prototype.exists=function(){return!!window[this.storageType].getItem(this.collection)},o.prototype.on=function(t,e){if("function"!=typeof e)throw new Error("onSave methods expects a function");if(["find","save","erase","update"].indexOf(t)<0)throw new Error(t+" is invalid event");this.callbackStack[t].push(e)},o})}])});
//# sourceMappingURL=storm.min.js.map